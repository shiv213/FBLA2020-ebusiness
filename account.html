<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>Classic - Account</title>
    <link rel="apple-touch-icon" sizes="180x180" href="assets/img/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="assets/img/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="assets/img/favicon-16x16.png">
    <link rel="manifest" href="assets/site.webmanifest">
    <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Kaushan+Script">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic,700italic">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.1/css/all.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css">
    <link rel="stylesheet" href="assets/fonts/fontawesome5-overrides.min.css">
    <link rel="stylesheet" href="assets/css/Article-List.css">
    <link rel="stylesheet" href="assets/css/clean-responsive-pricing.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/lightbox2/2.8.2/css/lightbox.min.css">
    <link rel="stylesheet" href="assets/css/Lightbox-Gallery.css">
    <link rel="stylesheet" href="assets/css/MUSA_carousel-product-cart-slider.css">
    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/7.6.2/firebase-app.js"></script>
    <!-- TODO: Add SDKs for Firebase products that you want to use
         https://firebase.google.com/docs/web/setup#available-libraries -->
    <script src="https://www.gstatic.com/firebasejs/7.6.2/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.6.2/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.6.2/firebase-analytics.js"></script>
    <script src="assets/js/firebase.js"></script>
    <script src="https://cdn.firebase.com/libs/firebaseui/3.5.2/firebaseui.js"></script>
    <link type="text/css" rel="stylesheet" href="https://cdn.firebase.com/libs/firebaseui/3.5.2/firebaseui.css"/>
</head>

<body>
<nav class="navbar navbar-dark navbar-expand-lg fixed-top bg-dark" id="mainNav">
    <div class="container">
        <button data-toggle="collapse" data-target="#navbarResponsive" class="navbar-toggler navbar-toggler-right"
                type="button" data-toogle="collapse" aria-controls="navbarResponsive" aria-expanded="false"
                aria-label="Toggle navigation"><i class="fa fa-bars"></i></button>
        <a href="index.html"><img src="assets/img/logo.svg" style="height: 50px;padding: 0.25%;"></a>
        <div class="collapse navbar-collapse" id="navbarResponsive">
            <ul class="nav navbar-nav ml-auto text-uppercase">
                <li class="nav-item" role="presentation"><a class="nav-link js-scroll-trigger" href="index.html#about">About</a>
                </li>
                <li class="nav-item" role="presentation"><a class="nav-link js-scroll-trigger"
                                                            href="index.html#gallery">Gallery</a></li>
                <li class="nav-item" role="presentation"><a class="nav-link js-scroll-trigger" href="index.html#plans">PRICING</a>
                </li>
                <li class="nav-item" role="presentation"><a class="nav-link js-scroll-trigger" href="index.html#team">Team</a>
                </li>
                <li class="nav-item" role="presentation"><a class="nav-link js-scroll-trigger" href="cart.html">CART</a>
                </li>
                <li class="nav-item" id="logoutNav" role="presentation" hidden>
                    <a class="nav-link js-scroll-trigger" onclick="logOut()" href="#">LOGOUT</a>
                </li>
                <li class="nav-item" role="presentation">
                    <a class="nav-link" href="account.html">
                        <i class="fas fa-user"></i>
                        <img style="border-radius: 50%;" id="profileImg" src="" alt=""/>
                    </a>
                </li>
            </ul>
        </div>
    </div>
</nav>
<script>
    // firebase.auth().setPersistence(firebase.auth.Auth.Persistence.LOCAL)
    //     .then(function () {
    //         // Existing and future Auth states are now persisted in the current
    //         // session only. Closing the window would clear any existing state even
    //         // if a user forgets to sign out.
    //         // ...
    //         // New sign-in will be persisted with session persistence.
    //         return firebase.auth().signInWithEmailAndPassword(email, password);
    //     })
    //     .catch(function (error) {
    //         // Handle Errors here.
    //         var errorCode = error.code;
    //         var errorMessage = error.message;
    //     });

    var ui = new firebaseui.auth.AuthUI(firebase.auth());
    var uiConfig = {
        callbacks: {
            signInSuccessWithAuthResult: function (authResult, redirectUrl) {
                // User successfully signed in.
                // Return type determines whether we continue the redirect automatically
                // or whether we leave that to developer to handle.
                // TODO SHOW PROFILE
                updateLoggedIn();
                return false;
            },
            uiShown: function () {
                // The widget is rendered.
                // Hide the loader.
                document.getElementById('loader').style.display = 'none';
            }
        },
        // Will use popup for IDP Providers sign-in flow instead of the default, redirect.
        signInFlow: 'popup',
        signInSuccessUrl: 'account.html',
        signInOptions: [
            // Leave the lines as is for the providers you want to offer your users.
            {
                provider: firebase.auth.GoogleAuthProvider.PROVIDER_ID,
                scopes: [
                    'email',
                    'profile'
                ],
                customParameters: {
                    // Forces account selection even when one account
                    // is available.
                    prompt: 'select_account'
                }
            },
            // firebase.auth.FacebookAuthProvider.PROVIDER_ID,
            // firebase.auth.TwitterAuthProvider.PROVIDER_ID,
            // firebase.auth.GithubAuthProvider.PROVIDER_ID,
            firebase.auth.EmailAuthProvider.PROVIDER_ID
            // firebase.auth.PhoneAuthProvider.PROVIDER_ID
        ],
        // Terms of service url.
        tosUrl: '<your-tos-url>',
        // Privacy policy url.
        privacyPolicyUrl: '<your-privacy-policy-url>'
    };
    // console.log(user);
    firebase.auth().onAuthStateChanged(function (user) {
        if (!user) {
            ui.start('#firebaseui-auth-container', uiConfig);
            document.getElementById('LOGIN').hidden = false;

        } else {
            updateLoggedIn();
        }
    });

    function updateLoggedIn() {

        document.getElementById('loader').style.display = 'none';
        document.getElementById('name').innerText = name;
        if (photoUrl != null) {
            document.getElementById('profilePicture').src = photoUrl;
            document.getElementById("profilePicture").height = window.innerHeight * .2;
            document.getElementById("profilePicture").alt = name;
        }
        database.ref('users/' + uid + '/subscription').once('value').then(function (snapshot) {
            document.getElementById("subscription").innerHTML = snapshot.val() || 'None';
        });
        document.getElementById('profile').hidden = false;
        document.getElementById('LOGIN').hidden = true;
    }
</script>
<div style="margin-top: 15%;"></div>
<h1 id="LOGIN" style="text-align: center" hidden>Log In</h1>
<div id="firebaseui-auth-container"></div>
<div style="text-align: center" id="loader">Loading...</div>

<div style="text-align: center" id="profile" hidden>
    <img style="border-radius: 50%" id="profilePicture" src=""/>
    <br/>
    <br/>
    <h1 style="" id="name"></h1>
    <h2>Subscription Status: </h2>
    <h3 id="subscription">None</h3>
</div>
<div class="container"></div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.4.1/jquery.easing.min.js"></script>
<script src="assets/js/agency.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/lightbox2/2.8.2/js/lightbox.min.js"></script>
</body>

</html>